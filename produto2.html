<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MARIA MAKEUP</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Fonte Google -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <style>
      html, body {
        height: 100%;
        margin: 0;
        font-family: 'Montserrat', sans-serif;
        background-color: #f4f4f4;
      }
      body {
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }
      .navbar {
        background-color: #000;
      }
      .navbar-brand {
        font-size: 1.5rem;
        font-weight: 700; 
        color: #fff;
      }
      .navbar-nav .nav-link {
        color: #fff;
        font-weight: 500;
        margin-right: 15px;
      }
      .content {
        flex: 1;
        padding: 60px 30px;
      }
      h1 {
        text-align: center;
        margin-bottom: 40px;
        font-size: 2.5rem; 
        color: #000;
        font-weight: bold;
      }
      .btn-primary {
        display: block;
        margin: 0 auto 10px; /* Distância entre os botões */
        padding: 10px 30px;
        border-radius: 25px;
        background-color: #ff0073;
        border: none;
        color: white;
        transition: background-color 0.3s, transform 0.2s;
      }
      .btn-primary:hover {
        background-color: #ff4edf;
        transform: scale(1.05);
      }
      .btn-secondary {
        display: block;
        margin: 10px auto 0; /* Espaçamento entre os botões */
        padding: 10px 30px;
        border-radius: 25px;
        background-color: #6f42c1; /* Cor roxa */
        border: none;
        color: white;
        transition: background-color 0.3s, transform 0.2s;
      }
      .btn-secondary:hover {
        background-color: #845ef7; /* Tom mais claro ao passar o mouse */
        transform: scale(1.05);
      }
      .products-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
      }
      .product {
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        background: linear-gradient(135deg, #ffeef8 0%, #ffe1f2 100%);
      }
      .product img {
        max-width: 100%; 
        height: auto;
        border-radius: 5px;
      }
      .product h4 {
        color: #800000;
        margin-top: 10px;
        font-size: 1.2rem;
        font-weight: bold;
      }
      .product p {
        color: #000;
      }
      .footer {
        background-color: #000;
        color: #fff;
        text-align: center;
        padding: 10px;
        font-size: 14px;
        margin-top: auto;
      }
    </style>
  </head>
  <body>
    <!-- Menu Principal -->
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container">
        <a class="navbar-brand" href="#">MARIA MAKEUP</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">HOME</a> <!-- Corrigido para linkar para a página inicial -->
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contato.html">CONTATO</a> <!-- Corrigido para linkar para a página de contato -->
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="servicosDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                PRODUTOS
              </a>
              <ul class="dropdown-menu" aria-labelledby="servicosDropdown">
                <li><a class="dropdown-item" href="produto1.html">Buscar por marca</a></li>
                <li><a class="dropdown-item" href="produto2.html">Buscar por categoria</a></li>
                <li><a class="dropdown-item" href="produto3.html">Buscar por preço</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Conteúdo Principal -->
    <div class="content" id="productContainer">
        <h1>PRODUTOS POR CATEGORIA</h1>
        <div class="text-center mb-4">
          <label for="categorySelect" class="form-label">Escolha uma categoria:</label>
          <select id="categorySelect" class="form-select" style="width: 300px; margin: 0 auto;">
            <option value="eyeshadow">Sombra</option>
            <option value="lipstick">Batom</option>
            <option value="foundation">Base</option>
            <option value="mascara">Máscara para cílios</option>
            <option value="blush">Blush</option>
          </select>
        </div>
        <button id="loadProducts" class="btn btn-primary">Carregar Produtos</button>
        <button id="showLogs" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#exampleModal">Exibir Logs</button>
        <div id="productsList" class="products-list"></div>
    </div>
  
    <!-- Modal para Exibir Logs -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body" >
            <table class="table table-hover table-striped">
              <thead class="table-dark">
                <tr>
                  <th scope="col" class="px-3 py-2">ID</th>
                  <th scope="col" class="px-3 py-2">Log</th>
                  <th scope="col" class="px-3 py-2">API</th>
                  <th scope="col" class="px-3 py-2">Método</th>
                  <th scope="col" class="px-3 py-2">Resultado</th>
                  <th scope="col" class="px-3 py-2">Ação</th>
                </tr>
              </thead>
              <tbody id="logs"></tbody> <!-- Os registros serão adicionados dinamicamente aqui -->
            </table>
          </div>
          
        </div>
      </div>
    </div>

    <!-- Rodapé -->
  <footer class="footer">
    <p>&copy; 2024 Maria Eduarda Rodrigues <br> Sistemas de Informação</p>
  </footer>

  <!-- JavaScript do Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>

    <script>
      document.getElementById('showLogs').addEventListener('click', exibirLogs);
document.getElementById('loadProducts').addEventListener('click', async () => {
    const category = document.getElementById('categorySelect').value; // Pegar valor da categoria selecionada
    const response = await fetch(`https://makeup-api.herokuapp.com/api/v1/products.json?product_type=${category}`);
    const products = await response.json();
    const productsList = document.getElementById('productsList');
    productsList.innerHTML = ''; // Limpar a lista antes de adicionar os novos produtos

    products.forEach(product => {
        const productDiv = document.createElement('div');
        productDiv.classList.add('product');
        productDiv.innerHTML = `
            <h4>${product.name}</h4>
            <p><strong>Marca:</strong> ${product.brand}</p>
            <p><strong>Preço:</strong> R$ ${product.price ? product.price : 'Preço não disponível'}</p>
        `;

        // Adicionando evento de clique para o modal
        productDiv.addEventListener('click', () => {
            const modalContent = `
                <h4>${product.name}</h4>
                <p><strong>Marca:</strong> ${product.brand}</p>
                <p><strong>Preço:</strong> R$ ${product.price || 'N/A'}</p>
                <p><strong>Descrição:</strong> ${product.description || 'Sem descrição disponível.'}</p>
            `;
            document.getElementById('modalProductDetails').innerHTML = modalContent;
            const modal = new bootstrap.Modal(document.getElementById('productModal'));
            modal.show(); // Mostrar o modal
        });

        productsList.appendChild(productDiv); // Adicionar o produto à lista
    });

    // Inserir o log após carregar todos os produtos
    insirirLog(products.length);
});

const matricula = '435012'; // Substitua pelo seu número de matrícula

function insirirLog(prod) {
    const apiLogs = `https://www.piway.com.br/unoesc/api/inserir/log/${matricula}/swapi/produtosporcategoria/${prod}`;
    fetch(apiLogs)
        .then(response => response.json())
        .then(data => {
            console.log(data);
        });
    exibirLogs();
}

function exibirLogs() {
    const api = `https://www.piway.com.br/unoesc/api/logs/${matricula}`;
    fetch(api)
        .then(response => response.json())
        .then(data => {
            const logs = document.getElementById("logs");
            logs.innerHTML = '';

            data.forEach(log => {
                const row = document.createElement('tr');
                row.className = "table-light border-bottom"; // Classes Bootstrap
                row.innerHTML = `
                  <td class="px-3 py-2">${log.idlog}</td>
                  <td class="px-3 py-2">${log.log}</td>
                  <td class="px-3 py-2">${log.api}</td>
                  <td class="px-3 py-2">${log.metodo}</td>
                  <td class="px-3 py-2">${log.resultado}</td>
                  <td class="px-3 py-2">
                    <button type="button" onclick="deleteLog(${log.idlog})" class="btn btn-danger btn-sm d-inline-flex align-items-center">
                      <i class="bi bi-trash me-2"></i>Lixeira
                    </button>
                  </td>
                `;
                logs.appendChild(row);
            });
        });
}

function deleteLog(idlog) {
    const api = `https://www.piway.com.br/unoesc/api/excluir/log/${idlog}/aluno/${matricula}`;
    fetch(api).then(() => exibirLogs());
}

    </script>
</body>
</html>
